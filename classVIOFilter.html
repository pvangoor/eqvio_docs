<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>eqvio: VIOFilter Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">eqvio
   &#160;<span id="projectnumber">1.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classVIOFilter-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">VIOFilter Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The implementation of the EqF for VIO.  
 <a href="classVIOFilter.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="VIOFilter_8h_source.html">VIOFilter.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for VIOFilter:</div>
<div class="dyncontent">
<div class="center"><img src="classVIOFilter__coll__graph.png" border="0" usemap="#VIOFilter_coll__map" alt="Collaboration graph"/></div>
<map name="VIOFilter_coll__map" id="VIOFilter_coll__map">
<area shape="rect" title="The implementation of the EqF for VIO." alt="" coords="254,273,331,300"/>
<area shape="rect" href="structVIO__eqf.html" title="The implementation of the EqF for VIO." alt="" coords="256,184,329,211"/>
<area shape="rect" href="structEqFCoordinateSuite.html" title="The suite of functions associated with a choice of coordinates for the EqF." alt="" coords="52,95,203,121"/>
<area shape="rect" href="structCoordinateChart.html" title=" " alt="" coords="5,5,220,32"/>
<area shape="rect" href="structVIOState.html" title="The states of the VIO system." alt="" coords="253,95,332,121"/>
<area shape="rect" href="structVIOSensorState.html" title="The states of the sensors of the VIO system." alt="" coords="245,5,367,32"/>
<area shape="rect" href="structVIOGroup.html" title="The Lie group used for VIO." alt="" coords="356,95,440,121"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structVIOFilter_1_1Settings.html">Settings</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The settings of the EqF for VIO.  <a href="structVIOFilter_1_1Settings.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a666a3413e027f049fe82065a0a4cd0b3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVIOFilter.html#a666a3413e027f049fe82065a0a4cd0b3">VIOFilter</a> (const <a class="el" href="structVIOFilter_1_1Settings.html">VIOFilter::Settings</a> &amp;<a class="el" href="classVIOFilter.html#aad5e643d245dee8489cbae3dd5f7a2fa">settings</a>)</td></tr>
<tr class="memdesc:a666a3413e027f049fe82065a0a4cd0b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create the filter using the given settings.  <a href="classVIOFilter.html#a666a3413e027f049fe82065a0a4cd0b3">More...</a><br /></td></tr>
<tr class="separator:a666a3413e027f049fe82065a0a4cd0b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46391678120973b3cf4570bc5e08fd38"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVIOFilter.html#a46391678120973b3cf4570bc5e08fd38">VIOFilter</a> (const <a class="el" href="structVIOState.html">VIOState</a> &amp;xi0, const <a class="el" href="structVIOFilter_1_1Settings.html">VIOFilter::Settings</a> &amp;<a class="el" href="classVIOFilter.html#aad5e643d245dee8489cbae3dd5f7a2fa">settings</a>, const double &amp;time=0.0)</td></tr>
<tr class="memdesc:a46391678120973b3cf4570bc5e08fd38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create the filter with given initial condition.  <a href="classVIOFilter.html#a46391678120973b3cf4570bc5e08fd38">More...</a><br /></td></tr>
<tr class="separator:a46391678120973b3cf4570bc5e08fd38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26fd317292c498fbf744556e479d9820"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVIOFilter.html#a26fd317292c498fbf744556e479d9820">initialiseFromIMUData</a> (const <a class="el" href="structIMUVelocity.html">IMUVelocity</a> &amp;imuVelocity)</td></tr>
<tr class="memdesc:a26fd317292c498fbf744556e479d9820"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise the EqF states using an IMU velocity measurement.  <a href="classVIOFilter.html#a26fd317292c498fbf744556e479d9820">More...</a><br /></td></tr>
<tr class="separator:a26fd317292c498fbf744556e479d9820"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05118d5a1b771aed7b384e84bb341108"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVIOFilter.html#a05118d5a1b771aed7b384e84bb341108">setState</a> (const <a class="el" href="structVIOState.html">VIOState</a> &amp;xi)</td></tr>
<tr class="memdesc:a05118d5a1b771aed7b384e84bb341108"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the EqF using the given state xi.  <a href="classVIOFilter.html#a05118d5a1b771aed7b384e84bb341108">More...</a><br /></td></tr>
<tr class="separator:a05118d5a1b771aed7b384e84bb341108"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d511e448d3dd34e0ad25411f28c7958"><td class="memItemLeft" align="right" valign="top"><a id="a9d511e448d3dd34e0ad25411f28c7958"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>setLandmarks</b> (const std::vector&lt; <a class="el" href="structLandmark.html">Landmark</a> &gt; &amp;cameraLandmarks)</td></tr>
<tr class="separator:a9d511e448d3dd34e0ad25411f28c7958"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa94ce1224a4146f4045efc5b8e59e308"><td class="memItemLeft" align="right" valign="top"><a id="aa94ce1224a4146f4045efc5b8e59e308"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>augmentLandmarkStates</b> (const std::vector&lt; int &gt; &amp;newIds, const <a class="el" href="structVIOState.html">VIOState</a> &amp;providedState)</td></tr>
<tr class="separator:aa94ce1224a4146f4045efc5b8e59e308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a787faa9c8ad05a0eeeaa88076ac381bd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVIOFilter.html#a787faa9c8ad05a0eeeaa88076ac381bd">processIMUData</a> (const <a class="el" href="structIMUVelocity.html">IMUVelocity</a> &amp;imuVelocity)</td></tr>
<tr class="memdesc:a787faa9c8ad05a0eeeaa88076ac381bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process an IMU velocity measurement.  <a href="classVIOFilter.html#a787faa9c8ad05a0eeeaa88076ac381bd">More...</a><br /></td></tr>
<tr class="separator:a787faa9c8ad05a0eeeaa88076ac381bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c10aed6c58f2b292be63523a57b8b2e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVIOFilter.html#a2c10aed6c58f2b292be63523a57b8b2e">processVisionData</a> (const <a class="el" href="structVisionMeasurement.html">VisionMeasurement</a> &amp;measurement)</td></tr>
<tr class="memdesc:a2c10aed6c58f2b292be63523a57b8b2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process a vision measurement.  <a href="classVIOFilter.html#a2c10aed6c58f2b292be63523a57b8b2e">More...</a><br /></td></tr>
<tr class="separator:a2c10aed6c58f2b292be63523a57b8b2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8706a7ab61bfde3e717253f455aa591d"><td class="memItemLeft" align="right" valign="top"><a id="a8706a7ab61bfde3e717253f455aa591d"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVIOFilter.html#a8706a7ab61bfde3e717253f455aa591d">getTime</a> () const</td></tr>
<tr class="memdesc:a8706a7ab61bfde3e717253f455aa591d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the current filter time. <br /></td></tr>
<tr class="separator:a8706a7ab61bfde3e717253f455aa591d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a058d8c5c5b709e7c1ab87818dc4d036e"><td class="memItemLeft" align="right" valign="top"><a id="a058d8c5c5b709e7c1ab87818dc4d036e"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVIOFilter.html#a058d8c5c5b709e7c1ab87818dc4d036e">isInitialised</a> () const</td></tr>
<tr class="memdesc:a058d8c5c5b709e7c1ab87818dc4d036e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return true once the filter is initialised from and IMU velocity. <br /></td></tr>
<tr class="separator:a058d8c5c5b709e7c1ab87818dc4d036e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a523e1fe804a5b79cd3c2a0fb569a2ce5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structVisionMeasurement.html">VisionMeasurement</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVIOFilter.html#a523e1fe804a5b79cd3c2a0fb569a2ce5">getFeaturePredictions</a> (const GIFT::GICameraPtr &amp;camPtr, const double &amp;stamp=-1)</td></tr>
<tr class="memdesc:a523e1fe804a5b79cd3c2a0fb569a2ce5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provide estimated feature measurements.  <a href="classVIOFilter.html#a523e1fe804a5b79cd3c2a0fb569a2ce5">More...</a><br /></td></tr>
<tr class="separator:a523e1fe804a5b79cd3c2a0fb569a2ce5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba547fc164d112b72a1941eb17ca91bb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structVIOState.html">VIOState</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVIOFilter.html#aba547fc164d112b72a1941eb17ca91bb">stateEstimate</a> () const</td></tr>
<tr class="memdesc:aba547fc164d112b72a1941eb17ca91bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provide the current system state estimate.  <a href="classVIOFilter.html#aba547fc164d112b72a1941eb17ca91bb">More...</a><br /></td></tr>
<tr class="separator:aba547fc164d112b72a1941eb17ca91bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a7fc373c4397d0f847368b7548afae3"><td class="memItemLeft" align="right" valign="top"><a id="a4a7fc373c4397d0f847368b7548afae3"></a>
const <a class="el" href="structVIO__eqf.html">VIO_eqf</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>viewEqFState</b> () const</td></tr>
<tr class="separator:a4a7fc373c4397d0f847368b7548afae3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:aad5e643d245dee8489cbae3dd5f7a2fa"><td class="memItemLeft" align="right" valign="top"><a id="aad5e643d245dee8489cbae3dd5f7a2fa"></a>
std::unique_ptr&lt; <a class="el" href="structVIOFilter_1_1Settings.html">VIOFilter::Settings</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVIOFilter.html#aad5e643d245dee8489cbae3dd5f7a2fa">settings</a></td></tr>
<tr class="memdesc:aad5e643d245dee8489cbae3dd5f7a2fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">The filter settings, including noise parameters and discretisation settings. <br /></td></tr>
<tr class="separator:aad5e643d245dee8489cbae3dd5f7a2fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:ac1b91875bb60d372c815d9e48aa5fa90"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVIOFilter.html#ac1b91875bb60d372c815d9e48aa5fa90">integrateUpToTime</a> (const double &amp;newTime)</td></tr>
<tr class="memdesc:ac1b91875bb60d372c815d9e48aa5fa90"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integrate the EqF dynamics to the given time without correction terms.  <a href="classVIOFilter.html#ac1b91875bb60d372c815d9e48aa5fa90">More...</a><br /></td></tr>
<tr class="separator:ac1b91875bb60d372c815d9e48aa5fa90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5b6ef3b712a0449371d3bae7dfaac3d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVIOFilter.html#ad5b6ef3b712a0449371d3bae7dfaac3d">addNewLandmarks</a> (const <a class="el" href="structVisionMeasurement.html">VisionMeasurement</a> &amp;measurement)</td></tr>
<tr class="memdesc:ad5b6ef3b712a0449371d3bae7dfaac3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add new landmarks to the EqF state from the provided features.  <a href="classVIOFilter.html#ad5b6ef3b712a0449371d3bae7dfaac3d">More...</a><br /></td></tr>
<tr class="separator:ad5b6ef3b712a0449371d3bae7dfaac3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1887c641147e5e57cc8c9b4fd350ff4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVIOFilter.html#ab1887c641147e5e57cc8c9b4fd350ff4">removeOldLandmarks</a> (const std::vector&lt; int &gt; &amp;measurementIds)</td></tr>
<tr class="memdesc:ab1887c641147e5e57cc8c9b4fd350ff4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes all landmarks with id numbers that do not appear in measurementIds.  <a href="classVIOFilter.html#ab1887c641147e5e57cc8c9b4fd350ff4">More...</a><br /></td></tr>
<tr class="separator:ab1887c641147e5e57cc8c9b4fd350ff4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91da1d311a309b2660ef3676fd2ebca4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVIOFilter.html#a91da1d311a309b2660ef3676fd2ebca4">removeOutliers</a> (<a class="el" href="structVisionMeasurement.html">VisionMeasurement</a> &amp;measurement)</td></tr>
<tr class="memdesc:a91da1d311a309b2660ef3676fd2ebca4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Identify landmarks with outlier measurements and remove them from the EqF states and the measurement, respectively.  <a href="classVIOFilter.html#a91da1d311a309b2660ef3676fd2ebca4">More...</a><br /></td></tr>
<tr class="separator:a91da1d311a309b2660ef3676fd2ebca4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cc8b00174627c85f619004143ca55b9"><td class="memItemLeft" align="right" valign="top"><a id="a4cc8b00174627c85f619004143ca55b9"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVIOFilter.html#a4cc8b00174627c85f619004143ca55b9">getMedianSceneDepth</a> () const</td></tr>
<tr class="memdesc:a4cc8b00174627c85f619004143ca55b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the median of the depth values of all the landmarks. <br /></td></tr>
<tr class="separator:a4cc8b00174627c85f619004143ca55b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a535f3d988b9487899ebdcc703b6c40bc"><td class="memItemLeft" align="right" valign="top"><a id="a535f3d988b9487899ebdcc703b6c40bc"></a>
<a class="el" href="structVIO__eqf.html">VIO_eqf</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVIOFilter.html#a535f3d988b9487899ebdcc703b6c40bc">filterState</a></td></tr>
<tr class="memdesc:a535f3d988b9487899ebdcc703b6c40bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">The state of the underlying EqF. <br /></td></tr>
<tr class="separator:a535f3d988b9487899ebdcc703b6c40bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcaa8756b5ee9c0a531b8ff351bd3cc8"><td class="memItemLeft" align="right" valign="top"><a id="adcaa8756b5ee9c0a531b8ff351bd3cc8"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVIOFilter.html#adcaa8756b5ee9c0a531b8ff351bd3cc8">initialisedFlag</a> = false</td></tr>
<tr class="memdesc:adcaa8756b5ee9c0a531b8ff351bd3cc8"><td class="mdescLeft">&#160;</td><td class="mdescRight">True once the EqF has been initialised from an IMU velocity measurement. <br /></td></tr>
<tr class="separator:adcaa8756b5ee9c0a531b8ff351bd3cc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79f23cea5184559b8ede46bd40e00098"><td class="memItemLeft" align="right" valign="top"><a id="a79f23cea5184559b8ede46bd40e00098"></a>
std::vector&lt; <a class="el" href="structIMUVelocity.html">IMUVelocity</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVIOFilter.html#a79f23cea5184559b8ede46bd40e00098">velocityBuffer</a></td></tr>
<tr class="memdesc:a79f23cea5184559b8ede46bd40e00098"><td class="mdescLeft">&#160;</td><td class="mdescRight">The IMU velocity measurement buffer. <br /></td></tr>
<tr class="separator:a79f23cea5184559b8ede46bd40e00098"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a2957bf22d78c274275893bb6b8c38b30"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classCSVLine.html">CSVLine</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVIOFilter.html#a2957bf22d78c274275893bb6b8c38b30">operator&lt;&lt;</a> (<a class="el" href="classCSVLine.html">CSVLine</a> &amp;line, const <a class="el" href="classVIOFilter.html">VIOFilter</a> &amp;filter)</td></tr>
<tr class="memdesc:a2957bf22d78c274275893bb6b8c38b30"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write an the filter states to a file.  <a href="classVIOFilter.html#a2957bf22d78c274275893bb6b8c38b30">More...</a><br /></td></tr>
<tr class="separator:a2957bf22d78c274275893bb6b8c38b30"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The implementation of the EqF for VIO. </p>
<p>This class implements the equivariant filter for visual inertial odometry. Aside from the basic EqF dynamics, this implementation also features methods for outlier rejection, state augmentation, and buffering IMU measurements. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a666a3413e027f049fe82065a0a4cd0b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a666a3413e027f049fe82065a0a4cd0b3">&#9670;&nbsp;</a></span>VIOFilter() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VIOFilter::VIOFilter </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structVIOFilter_1_1Settings.html">VIOFilter::Settings</a> &amp;&#160;</td>
          <td class="paramname"><em>settings</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create the filter using the given settings. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">settings</td><td>The initial settings to use. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a46391678120973b3cf4570bc5e08fd38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46391678120973b3cf4570bc5e08fd38">&#9670;&nbsp;</a></span>VIOFilter() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VIOFilter::VIOFilter </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structVIOState.html">VIOState</a> &amp;&#160;</td>
          <td class="paramname"><em>xi0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structVIOFilter_1_1Settings.html">VIOFilter::Settings</a> &amp;&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>time</em> = <code>0.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create the filter with given initial condition. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">xi0</td><td>The initial state estimate. </td></tr>
    <tr><td class="paramname">settings</td><td>The settings to use in noise matrices. </td></tr>
    <tr><td class="paramname">time</td><td>The initial time of the filter </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ad5b6ef3b712a0449371d3bae7dfaac3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5b6ef3b712a0449371d3bae7dfaac3d">&#9670;&nbsp;</a></span>addNewLandmarks()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void VIOFilter::addNewLandmarks </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structVisionMeasurement.html">VisionMeasurement</a> &amp;&#160;</td>
          <td class="paramname"><em>measurement</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add new landmarks to the EqF state from the provided features. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">measurement</td><td>The features to use when adding new landmarks.</td></tr>
  </table>
  </dd>
</dl>
<p>If there are any features with id numbers that are not already part of the state, then new landmark states are added to the state from those features. Depending on the chosen settings, these landmarks are initialised with either the median scene depth or a fixed depth value. </p>

</div>
</div>
<a id="a523e1fe804a5b79cd3c2a0fb569a2ce5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a523e1fe804a5b79cd3c2a0fb569a2ce5">&#9670;&nbsp;</a></span>getFeaturePredictions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structVisionMeasurement.html">VisionMeasurement</a> VIOFilter::getFeaturePredictions </td>
          <td>(</td>
          <td class="paramtype">const GIFT::GICameraPtr &amp;&#160;</td>
          <td class="paramname"><em>camPtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>stamp</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Provide estimated feature measurements. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">camPtr</td><td>The camera model used to compute the predictions </td></tr>
    <tr><td class="paramname">stamp</td><td>The requested time stamp of the predictions. Defaults to the current filter time.</td></tr>
  </table>
  </dd>
</dl>
<p>Compute the predicted feature measurements based on the provided camera model. If a time stamp is provided, then the filter is first integrated up to this time. This method can be helpful in aiding feature tracking under rapid motions. </p>

</div>
</div>
<a id="a26fd317292c498fbf744556e479d9820"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26fd317292c498fbf744556e479d9820">&#9670;&nbsp;</a></span>initialiseFromIMUData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VIOFilter::initialiseFromIMUData </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structIMUVelocity.html">IMUVelocity</a> &amp;&#160;</td>
          <td class="paramname"><em>imuVelocity</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise the EqF states using an IMU velocity measurement. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">imuVelocity</td><td>The IMU velocity to use in initialisation.</td></tr>
  </table>
  </dd>
</dl>
<p>It is assumed that the IMU acceleration is almost entirely due to gravity, allowing us to determine the pitch and roll components of the robot's orientation. It is important to do this at the start. </p>

</div>
</div>
<a id="ac1b91875bb60d372c815d9e48aa5fa90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1b91875bb60d372c815d9e48aa5fa90">&#9670;&nbsp;</a></span>integrateUpToTime()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool VIOFilter::integrateUpToTime </td>
          <td>(</td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>newTime</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Integrate the EqF dynamics to the given time without correction terms. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">newTime</td><td>The time to which the EqF states should be integrated. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True iff the integration could be performed.</dd></dl>
<p>If doRiccati is set to true, then the Riccati matrix is propagated without the correction terms. This is an expensive operation, however, so it is generally better just to propagate the Riccati upon receiving a new image measurement by using the average IMU velocity. If newTime is less than the current filter time or the filter is not yet initialised, then the integration cannot go ahead and this method returns false. </p>

</div>
</div>
<a id="a787faa9c8ad05a0eeeaa88076ac381bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a787faa9c8ad05a0eeeaa88076ac381bd">&#9670;&nbsp;</a></span>processIMUData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VIOFilter::processIMUData </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structIMUVelocity.html">IMUVelocity</a> &amp;&#160;</td>
          <td class="paramname"><em>imuVelocity</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Process an IMU velocity measurement. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">imuVelocity</td><td>The IMU velocity to process.</td></tr>
  </table>
  </dd>
</dl>
<p>The EqF is integrated using the given IMU velocity measurement. Depending on the settings, the Riccati matrix may or may not be propagated at this time. The given IMU velocity is recorded as the current velocity. </p>

</div>
</div>
<a id="a2c10aed6c58f2b292be63523a57b8b2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c10aed6c58f2b292be63523a57b8b2e">&#9670;&nbsp;</a></span>processVisionData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VIOFilter::processVisionData </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structVisionMeasurement.html">VisionMeasurement</a> &amp;&#160;</td>
          <td class="paramname"><em>measurement</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Process a vision measurement. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">measurement</td><td>The measurement of feature points obtained from the front-end.</td></tr>
  </table>
  </dd>
</dl>
<p>A number of steps are undertaken when processing vision data. First, the EqF is integrated using the latest velocity, and the Riccati matrix is propagated to the current time. Second, any landmarks that were not tracked successfully, or those that are associated with outlier measurements, are removed from the EqF state. Third and final, the EqF correction terms are computed and applied. </p>

</div>
</div>
<a id="ab1887c641147e5e57cc8c9b4fd350ff4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1887c641147e5e57cc8c9b4fd350ff4">&#9670;&nbsp;</a></span>removeOldLandmarks()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void VIOFilter::removeOldLandmarks </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>measurementIds</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Removes all landmarks with id numbers that do not appear in measurementIds. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">measurementIds</td><td>The ids of landmarks that will be kept. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a91da1d311a309b2660ef3676fd2ebca4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91da1d311a309b2660ef3676fd2ebca4">&#9670;&nbsp;</a></span>removeOutliers()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void VIOFilter::removeOutliers </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structVisionMeasurement.html">VisionMeasurement</a> &amp;&#160;</td>
          <td class="paramname"><em>measurement</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Identify landmarks with outlier measurements and remove them from the EqF states and the measurement, respectively. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">measurement</td><td>The current measurement.</td></tr>
  </table>
  </dd>
</dl>
<p>This method uses both an absolute check and a covariance-based check. If a measurement differs from the expected measurement by more than a set value, then it is considered an outlier. If weighted measurement distance is larger than a set value, it is also considered an outlier. </p>

</div>
</div>
<a id="a05118d5a1b771aed7b384e84bb341108"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05118d5a1b771aed7b384e84bb341108">&#9670;&nbsp;</a></span>setState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VIOFilter::setState </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structVIOState.html">VIOState</a> &amp;&#160;</td>
          <td class="paramname"><em>xi</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset the EqF using the given state xi. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">xi</td><td>The state to which the EqF should be set.</td></tr>
  </table>
  </dd>
</dl>
<p>Given a state xi, the origin xi0 is set to xi, the state X is set to identity, and the Riccati matrix Sigma is set to its default values. </p>

</div>
</div>
<a id="aba547fc164d112b72a1941eb17ca91bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba547fc164d112b72a1941eb17ca91bb">&#9670;&nbsp;</a></span>stateEstimate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structVIOState.html">VIOState</a> VIOFilter::stateEstimate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Provide the current system state estimate. </p>
<p>This is computed by applying the group action with the observer state X to the fixed origin configuration xi0. </p>

</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a id="a2957bf22d78c274275893bb6b8c38b30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2957bf22d78c274275893bb6b8c38b30">&#9670;&nbsp;</a></span>operator&lt;&lt;</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCSVLine.html">CSVLine</a>&amp; operator&lt;&lt; </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCSVLine.html">CSVLine</a> &amp;&#160;</td>
          <td class="paramname"><em>line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVIOFilter.html">VIOFilter</a> &amp;&#160;</td>
          <td class="paramname"><em>filter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write an the filter states to a file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">line</td><td>A reference to the CSV line where the data should be written. </td></tr>
    <tr><td class="paramname">filter</td><td>The filter states to write to the CSV line. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A reference to the CSV line with the data written.</dd></dl>
<p>The data is formatted in the CSV line as [xi0, X, Sigma] </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>include/eqvio/<a class="el" href="VIOFilter_8h_source.html">VIOFilter.h</a></li>
<li>src/VIOFilter.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
