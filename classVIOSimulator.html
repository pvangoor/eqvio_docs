<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>eqvio: VIOSimulator Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">eqvio
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classVIOSimulator-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">VIOSimulator Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A simulator for VIO measurements from a given groundtruth trajectory.  
 <a href="classVIOSimulator.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="VIOSimulator_8h_source.html">VIOSimulator.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a28a381619621dac6f870f54b8561cfe0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structVisionMeasurement.html">VisionMeasurement</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVIOSimulator.html#a28a381619621dac6f870f54b8561cfe0">getVision</a> (const double &amp;time) const</td></tr>
<tr class="memdesc:a28a381619621dac6f870f54b8561cfe0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a vision measurement at the given time.  <a href="classVIOSimulator.html#a28a381619621dac6f870f54b8561cfe0">More...</a><br /></td></tr>
<tr class="separator:a28a381619621dac6f870f54b8561cfe0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d80cc33cdcc21c93dddd3a29b1d2b79"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structIMUVelocity.html">IMUVelocity</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVIOSimulator.html#a1d80cc33cdcc21c93dddd3a29b1d2b79">getIMU</a> (const double &amp;time) const</td></tr>
<tr class="memdesc:a1d80cc33cdcc21c93dddd3a29b1d2b79"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get an IMU measurement at the given time.  <a href="classVIOSimulator.html#a1d80cc33cdcc21c93dddd3a29b1d2b79">More...</a><br /></td></tr>
<tr class="separator:a1d80cc33cdcc21c93dddd3a29b1d2b79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3cbbdd4532901f81df1b34e95168291"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; <a class="el" href="structStampedPose.html">StampedPose</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVIOSimulator.html#af3cbbdd4532901f81df1b34e95168291">viewPoses</a> () const</td></tr>
<tr class="memdesc:af3cbbdd4532901f81df1b34e95168291"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a const reference to the vector of ground truth poses.  <a href="classVIOSimulator.html#af3cbbdd4532901f81df1b34e95168291">More...</a><br /></td></tr>
<tr class="separator:af3cbbdd4532901f81df1b34e95168291"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89c555ef18211a173bbab35689e713bc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVIOSimulator.html#a89c555ef18211a173bbab35689e713bc">VIOSimulator</a> (const std::string &amp;posesFileName, const YAML::Node &amp;settings=YAML::Node(), const double timeScale=1.0, const int column=0, const char delim=',')</td></tr>
<tr class="memdesc:a89c555ef18211a173bbab35689e713bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a simulator from a groundtruth file and some settings.  <a href="classVIOSimulator.html#a89c555ef18211a173bbab35689e713bc">More...</a><br /></td></tr>
<tr class="separator:a89c555ef18211a173bbab35689e713bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a25b4f55b65d46918c2446c93390e2327"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structLandmark.html">Landmark</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVIOSimulator.html#a25b4f55b65d46918c2446c93390e2327">generateWorldPoints</a> (const int num=1000, const double distance=1.0) const</td></tr>
<tr class="memdesc:a25b4f55b65d46918c2446c93390e2327"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a number of points for the simulator world.  <a href="classVIOSimulator.html#a25b4f55b65d46918c2446c93390e2327">More...</a><br /></td></tr>
<tr class="separator:a25b4f55b65d46918c2446c93390e2327"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a9f5a44aa92f1172959fc818fa6eb06b0"><td class="memItemLeft" align="right" valign="top"><a id="a9f5a44aa92f1172959fc818fa6eb06b0"></a>
uint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVIOSimulator.html#a9f5a44aa92f1172959fc818fa6eb06b0">randomSeed</a></td></tr>
<tr class="memdesc:a9f5a44aa92f1172959fc818fa6eb06b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">The value used to seed the random number generation. <br /></td></tr>
<tr class="separator:a9f5a44aa92f1172959fc818fa6eb06b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a442317c3dff0ba9452121d99d9877a43"><td class="memItemLeft" align="right" valign="top"><a id="a442317c3dff0ba9452121d99d9877a43"></a>
std::map&lt; int, int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVIOSimulator.html#a442317c3dff0ba9452121d99d9877a43">pointId2TrackingId</a></td></tr>
<tr class="memdesc:a442317c3dff0ba9452121d99d9877a43"><td class="mdescLeft">&#160;</td><td class="mdescRight">A map from world point indexes to tracking id numbers. <br /></td></tr>
<tr class="separator:a442317c3dff0ba9452121d99d9877a43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8df29e54846fd455e82bf6421611b0f2"><td class="memItemLeft" align="right" valign="top"><a id="a8df29e54846fd455e82bf6421611b0f2"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVIOSimulator.html#a8df29e54846fd455e82bf6421611b0f2">currentTrackingId</a> = 0</td></tr>
<tr class="memdesc:a8df29e54846fd455e82bf6421611b0f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">The latest tracking id assigned to a point. <br /></td></tr>
<tr class="separator:a8df29e54846fd455e82bf6421611b0f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68c7a40b8ad734eeba43f604a420f8df"><td class="memItemLeft" align="right" valign="top"><a id="a68c7a40b8ad734eeba43f604a420f8df"></a>
std::vector&lt; <a class="el" href="structStampedPose.html">StampedPose</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVIOSimulator.html#a68c7a40b8ad734eeba43f604a420f8df">poses</a></td></tr>
<tr class="memdesc:a68c7a40b8ad734eeba43f604a420f8df"><td class="mdescLeft">&#160;</td><td class="mdescRight">All the ground truth poses with time stamps. <br /></td></tr>
<tr class="separator:a68c7a40b8ad734eeba43f604a420f8df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af577f63522e847a46e56962f6a6e264a"><td class="memItemLeft" align="right" valign="top"><a id="af577f63522e847a46e56962f6a6e264a"></a>
std::vector&lt; <a class="el" href="structLandmark.html">Landmark</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVIOSimulator.html#af577f63522e847a46e56962f6a6e264a">inertialPoints</a></td></tr>
<tr class="memdesc:af577f63522e847a46e56962f6a6e264a"><td class="mdescLeft">&#160;</td><td class="mdescRight">All the points generated for the simulation world. <br /></td></tr>
<tr class="separator:af577f63522e847a46e56962f6a6e264a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af754aca9ccfdec1bcfa8e07fd6906631"><td class="memItemLeft" align="right" valign="top"><a id="af754aca9ccfdec1bcfa8e07fd6906631"></a>
liepp::SE3d&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVIOSimulator.html#af754aca9ccfdec1bcfa8e07fd6906631">cameraOffset</a> = liepp::SE3d::Identity()</td></tr>
<tr class="memdesc:af754aca9ccfdec1bcfa8e07fd6906631"><td class="mdescLeft">&#160;</td><td class="mdescRight">The chosen offset between IMU and camera. <br /></td></tr>
<tr class="separator:af754aca9ccfdec1bcfa8e07fd6906631"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0f86da7206d2cb791042f2f93937433"><td class="memItemLeft" align="right" valign="top"><a id="af0f86da7206d2cb791042f2f93937433"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVIOSimulator.html#af0f86da7206d2cb791042f2f93937433">fieldOfView</a> = 60 * 3.14 / 180.</td></tr>
<tr class="memdesc:af0f86da7206d2cb791042f2f93937433"><td class="mdescLeft">&#160;</td><td class="mdescRight">The camera's desired field of view, in radians. <br /></td></tr>
<tr class="separator:af0f86da7206d2cb791042f2f93937433"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa25bc5f86c1f972a488135420957b33"><td class="memItemLeft" align="right" valign="top"><a id="aaa25bc5f86c1f972a488135420957b33"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVIOSimulator.html#aaa25bc5f86c1f972a488135420957b33">maxFeatures</a> = 30</td></tr>
<tr class="memdesc:aaa25bc5f86c1f972a488135420957b33"><td class="mdescLeft">&#160;</td><td class="mdescRight">The maximum number of features tracked at any given time. <br /></td></tr>
<tr class="separator:aaa25bc5f86c1f972a488135420957b33"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A simulator for VIO measurements from a given groundtruth trajectory. </p>
<p>This class is able to simulate IMU and feature measurements from a given groundtruth VIO trajectory. The simulation world has a large number of landmark points, and these are tracked between requests for vision measurements, similarly to a real-world feature tracking output. This code is mostly used for testing purposes, and can be used alongside real data to provide just IMU or just feature measurements. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a89c555ef18211a173bbab35689e713bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89c555ef18211a173bbab35689e713bc">&#9670;&nbsp;</a></span>VIOSimulator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VIOSimulator::VIOSimulator </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>posesFileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const YAML::Node &amp;&#160;</td>
          <td class="paramname"><em>settings</em> = <code>YAML::Node()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>timeScale</em> = <code>1.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>column</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char&#160;</td>
          <td class="paramname"><em>delim</em> = <code>','</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a simulator from a groundtruth file and some settings. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">posesFileName</td><td>The name of the groundtruth file </td></tr>
    <tr><td class="paramname">settings</td><td>The simulator settings YAML node </td></tr>
    <tr><td class="paramname">timeScale</td><td>The representation of time in the groundtruth file. e.g. 1.0e-9 for ns. </td></tr>
    <tr><td class="paramname">column</td><td>The first column with relevant data in the groundtruth file. </td></tr>
    <tr><td class="paramname">delim</td><td>The file delimiter</td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000006">Todo:</a></b></dt><dd>Reading groundtruth in this way should be the responsibility of the relevant datasetReader. The simulator constructor should instead just accept the list of stamped poses. </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a25b4f55b65d46918c2446c93390e2327"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25b4f55b65d46918c2446c93390e2327">&#9670;&nbsp;</a></span>generateWorldPoints()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; <a class="el" href="structLandmark.html">Landmark</a> &gt; VIOSimulator::generateWorldPoints </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>num</em> = <code>1000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>distance</em> = <code>1.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generate a number of points for the simulator world. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">num</td><td>The number of points to generate in the world. </td></tr>
    <tr><td class="paramname">distance</td><td>The distance of the world's walls from the trajectory. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The generated world points.</dd></dl>
<p>The world points are generated by determining simulation world walls, and then placing an even number of points on each of the six walls. The walls are determined as the extremities of the provided trajectory plus the given distance. </p>

</div>
</div>
<a id="a1d80cc33cdcc21c93dddd3a29b1d2b79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d80cc33cdcc21c93dddd3a29b1d2b79">&#9670;&nbsp;</a></span>getIMU()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structIMUVelocity.html">IMUVelocity</a> VIOSimulator::getIMU </td>
          <td>(</td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>time</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get an IMU measurement at the given time. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">time</td><td>The time of the IMU measurement. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The IMU velocity at the given time.</dd></dl>
<p>The IMU measurement at the given time is obtained by numerical differentiation using four groundtruth poses. </p>

</div>
</div>
<a id="a28a381619621dac6f870f54b8561cfe0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28a381619621dac6f870f54b8561cfe0">&#9670;&nbsp;</a></span>getVision()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structVisionMeasurement.html">VisionMeasurement</a> VIOSimulator::getVision </td>
          <td>(</td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>time</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a vision measurement at the given time. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">time</td><td>The time of the vision measurement. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The tracked features at the given time.</dd></dl>
<p>The currently tracked features are tracked to the given time, if possible. Then, if this is not the maximum number of features, new features are added from the world points. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000009">Todo:</a></b></dt><dd>Add camera support to the simulator </dd></dl>

</div>
</div>
<a id="af3cbbdd4532901f81df1b34e95168291"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3cbbdd4532901f81df1b34e95168291">&#9670;&nbsp;</a></span>viewPoses()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt; <a class="el" href="structStampedPose.html">StampedPose</a> &gt; &amp; VIOSimulator::viewPoses </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a const reference to the vector of ground truth poses. </p>
<dl class="section return"><dt>Returns</dt><dd>The ground truth stamped poses. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>include/eqvio/<a class="el" href="VIOSimulator_8h_source.html">VIOSimulator.h</a></li>
<li>src/VIOSimulator.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
