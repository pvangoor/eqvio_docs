<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>eqvio: aofstream Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">eqvio
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classaofstream-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">aofstream Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>asynchronous output file stream  
 <a href="classaofstream.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="aofstream_8h_source.html">aofstream.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a1eff13d5c1b6fb41dd9c51fa85c8c77e"><td class="memItemLeft" align="right" valign="top"><a id="a1eff13d5c1b6fb41dd9c51fa85c8c77e"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classaofstream.html#a1eff13d5c1b6fb41dd9c51fa85c8c77e">aofstream</a> (const std::string &amp;fname)</td></tr>
<tr class="memdesc:a1eff13d5c1b6fb41dd9c51fa85c8c77e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create an aofstream and immediately open fname for writing. <br /></td></tr>
<tr class="separator:a1eff13d5c1b6fb41dd9c51fa85c8c77e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0578c792f89d8d300e8edc1c9c58593f"><td class="memItemLeft" align="right" valign="top"><a id="a0578c792f89d8d300e8edc1c9c58593f"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classaofstream.html#a0578c792f89d8d300e8edc1c9c58593f">~aofstream</a> ()</td></tr>
<tr class="memdesc:a0578c792f89d8d300e8edc1c9c58593f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Empty the stream buffer and finish the writing thread before destruction. <br /></td></tr>
<tr class="separator:a0578c792f89d8d300e8edc1c9c58593f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84c1b36a662d2a9b4b6935b4b233697b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classaofstream.html#a84c1b36a662d2a9b4b6935b4b233697b">open</a> (const std::string &amp;fname)</td></tr>
<tr class="memdesc:a84c1b36a662d2a9b4b6935b4b233697b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Opens the given file for writing.  <a href="classaofstream.html#a84c1b36a662d2a9b4b6935b4b233697b">More...</a><br /></td></tr>
<tr class="separator:a84c1b36a662d2a9b4b6935b4b233697b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a328e07b9afcba71fbb159c957d95c8d7"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classaofstream.html#a328e07b9afcba71fbb159c957d95c8d7">is_open</a> ()</td></tr>
<tr class="memdesc:a328e07b9afcba71fbb159c957d95c8d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the associated output file is open.  <a href="classaofstream.html#a328e07b9afcba71fbb159c957d95c8d7">More...</a><br /></td></tr>
<tr class="separator:a328e07b9afcba71fbb159c957d95c8d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a640087f22de2c69ae5565b577b81396e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classaofstream.html">aofstream</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classaofstream.html#a640087f22de2c69ae5565b577b81396e">operator&lt;&lt;</a> (const auto &amp;data)</td></tr>
<tr class="memdesc:a640087f22de2c69ae5565b577b81396e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write data to the stream buffer to pass to the output file.  <a href="classaofstream.html#a640087f22de2c69ae5565b577b81396e">More...</a><br /></td></tr>
<tr class="separator:a640087f22de2c69ae5565b577b81396e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a80f50ab1af6f0ab6b154559293f418b6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classaofstream.html#a80f50ab1af6f0ab6b154559293f418b6">flushStreamToFile</a> ()</td></tr>
<tr class="memdesc:a80f50ab1af6f0ab6b154559293f418b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Regularly flush the output buffer to the output file.  <a href="classaofstream.html#a80f50ab1af6f0ab6b154559293f418b6">More...</a><br /></td></tr>
<tr class="separator:a80f50ab1af6f0ab6b154559293f418b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:aceb5bb5dc908a07f2f6207d241c8876f"><td class="memItemLeft" align="right" valign="top"><a id="aceb5bb5dc908a07f2f6207d241c8876f"></a>
std::ofstream&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classaofstream.html#aceb5bb5dc908a07f2f6207d241c8876f">outputFile</a></td></tr>
<tr class="memdesc:aceb5bb5dc908a07f2f6207d241c8876f"><td class="mdescLeft">&#160;</td><td class="mdescRight">The output file to which data is written. <br /></td></tr>
<tr class="separator:aceb5bb5dc908a07f2f6207d241c8876f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3ca80e2b4dde296b8bb994ea3057361"><td class="memItemLeft" align="right" valign="top"><a id="aa3ca80e2b4dde296b8bb994ea3057361"></a>
std::stringstream&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classaofstream.html#aa3ca80e2b4dde296b8bb994ea3057361">streamBuffer</a></td></tr>
<tr class="memdesc:aa3ca80e2b4dde296b8bb994ea3057361"><td class="mdescLeft">&#160;</td><td class="mdescRight">The buffer of data to write to the file. <br /></td></tr>
<tr class="separator:aa3ca80e2b4dde296b8bb994ea3057361"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e51556dc3f6fdfc9038fe4d49f8f88c"><td class="memItemLeft" align="right" valign="top"><a id="a7e51556dc3f6fdfc9038fe4d49f8f88c"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classaofstream.html#a7e51556dc3f6fdfc9038fe4d49f8f88c">destructorCalled</a> = false</td></tr>
<tr class="memdesc:a7e51556dc3f6fdfc9038fe4d49f8f88c"><td class="mdescLeft">&#160;</td><td class="mdescRight">A flag to break the output thread loop when the destructor is called. <br /></td></tr>
<tr class="separator:a7e51556dc3f6fdfc9038fe4d49f8f88c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec367e7f0768fd10c5d9af7f71167a49"><td class="memItemLeft" align="right" valign="top"><a id="aec367e7f0768fd10c5d9af7f71167a49"></a>
std::condition_variable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classaofstream.html#aec367e7f0768fd10c5d9af7f71167a49">buffer_cv</a></td></tr>
<tr class="memdesc:aec367e7f0768fd10c5d9af7f71167a49"><td class="mdescLeft">&#160;</td><td class="mdescRight">A condition variable that starts the output writing thread when new data is available. <br /></td></tr>
<tr class="separator:aec367e7f0768fd10c5d9af7f71167a49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afff3ccbdaeba857e03ed2cba19b9da52"><td class="memItemLeft" align="right" valign="top"><a id="afff3ccbdaeba857e03ed2cba19b9da52"></a>
std::thread&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classaofstream.html#afff3ccbdaeba857e03ed2cba19b9da52">writerThread</a></td></tr>
<tr class="memdesc:afff3ccbdaeba857e03ed2cba19b9da52"><td class="mdescLeft">&#160;</td><td class="mdescRight">The thread that writes the streamBuffer to the outputFile. <br /></td></tr>
<tr class="separator:afff3ccbdaeba857e03ed2cba19b9da52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1c529a51e78ab4a21d8eed9f976f9f3"><td class="memItemLeft" align="right" valign="top"><a id="ae1c529a51e78ab4a21d8eed9f976f9f3"></a>
std::mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classaofstream.html#ae1c529a51e78ab4a21d8eed9f976f9f3">streamMutex</a></td></tr>
<tr class="memdesc:ae1c529a51e78ab4a21d8eed9f976f9f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">A mutex to govern access to the stream buffer. <br /></td></tr>
<tr class="separator:ae1c529a51e78ab4a21d8eed9f976f9f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>asynchronous output file stream </p>
<p>Uses a std thread to write data to an output stream asynchronously. When data is received through &lt;&lt; by an aofstream, it is buffered into a stringstream. A separate thread (started upon opening the output file) is used to flush the buffer to the output file every few seconds. Upon destruction, the buffer is flushed completely and the thread is destroyed. By using this class instead of a std::ofstream to write output, the program can mostly avoid waiting on the OS. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a80f50ab1af6f0ab6b154559293f418b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80f50ab1af6f0ab6b154559293f418b6">&#9670;&nbsp;</a></span>flushStreamToFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void aofstream::flushStreamToFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Regularly flush the output buffer to the output file. </p>
<p>Every few seconds, the stream buffer is flushed to the output file. This loop is paused until new data is available and the condition variable is triggered. This function is intended to be run from the writerThread only. </p>

</div>
</div>
<a id="a328e07b9afcba71fbb159c957d95c8d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a328e07b9afcba71fbb159c957d95c8d7">&#9670;&nbsp;</a></span>is_open()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool aofstream::is_open </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks if the associated output file is open. </p>
<dl class="section return"><dt>Returns</dt><dd>true if the file is open. </dd></dl>

</div>
</div>
<a id="a84c1b36a662d2a9b4b6935b4b233697b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84c1b36a662d2a9b4b6935b4b233697b">&#9670;&nbsp;</a></span>open()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void aofstream::open </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>fname</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Opens the given file for writing. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fname</td><td>The name of the file to open. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a640087f22de2c69ae5565b577b81396e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a640087f22de2c69ae5565b577b81396e">&#9670;&nbsp;</a></span>operator&lt;&lt;()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classaofstream.html">aofstream</a>&amp; aofstream::operator&lt;&lt; </td>
          <td>(</td>
          <td class="paramtype">const auto &amp;&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write data to the stream buffer to pass to the output file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>The data to be written to the output file. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>this instance.</dd></dl>
<p>Acquires the buffer mutex and writes data to the streambuffer. This data is flushed to the output file by the writer thread. This function returns *this so that operator&lt;&lt; can be used in typical c++ fashion:</p>
<p>myAofstream &lt;&lt; data1 &lt;&lt; data2; </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>include/eqvio/<a class="el" href="aofstream_8h_source.html">aofstream.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
